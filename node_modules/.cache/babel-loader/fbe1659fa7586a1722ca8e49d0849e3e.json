{"ast":null,"code":"import _objectSpread from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";//firestore db\nimport{getFirestore,doc,getDoc,setDoc}from'firebase/firestore';// Import the functions you need from the SDKs you need\nimport{initializeApp}from\"firebase/app\";//create an app instance\nimport{getAuth,signInWithRedirect,signInWithPopup,signInWithPhoneNumber,GoogleAuthProvider,FacebookAuthProvider,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged}from'firebase/auth';// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n// Your web app's Firebase configuration\nvar firebaseConfig={apiKey:\"AIzaSyB8FvXvvHKJ3ax1iOArErBJwePdfWO7DBE\",authDomain:\"crown-clothing-db-39d8e.firebaseapp.com\",projectId:\"crown-clothing-db-39d8e\",storageBucket:\"crown-clothing-db-39d8e.appspot.com\",messagingSenderId:\"233166638813\",appId:\"1:233166638813:web:a2842dbd48732568c09534\"};// Initialize Firebase\nvar firebaseApp=initializeApp(firebaseConfig);var provider=new GoogleAuthProvider();var Facebookprovider=new FacebookAuthProvider();//use 不同的provider提供不同的auth，比如facebook，twitter等\nprovider.setCustomParameters({prompt:\"select_account\"});export var auth=getAuth();export var signinwithgooglePopup=function signinwithgooglePopup(){return signInWithPopup(auth,provider);};export var signInWithGoogleRedirect=function signInWithGoogleRedirect(){return signInWithRedirect(auth,provider);};export var createAuthUserWithEmailAndPassword=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(email,password){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!email||!password)){_context.next=2;break;}return _context.abrupt(\"return\");case 2:console.log(\"email create success\");_context.next=5;return createUserWithEmailAndPassword(auth,email,password);case 5:return _context.abrupt(\"return\",_context.sent);case 6:case\"end\":return _context.stop();}}},_callee);}));return function createAuthUserWithEmailAndPassword(_x,_x2){return _ref.apply(this,arguments);};}();export var signInAuthWithEmailAndPassword=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(email,password){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!email||!password)){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:console.log(\"sign in success\");_context2.next=5;return signInWithEmailAndPassword(auth,email,password);case 5:return _context2.abrupt(\"return\",_context2.sent);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function signInAuthWithEmailAndPassword(_x3,_x4){return _ref2.apply(this,arguments);};}();export var SignoutUser=function SignoutUser(){signOut(auth);};export var OnAuthstatecahngeListener=function OnAuthstatecahngeListener(callback){if(!callback)return;onAuthStateChanged(auth,callback);};////=---------firebase firestore db------------------///\n//firestore based on Doc model\nvar db=getFirestore();export var createUserDocFrom=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(userAuth){var addtionalInfo,userDocRef,userSnapshot,displayName,email,createAt,_args3=arguments;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:addtionalInfo=_args3.length>1&&_args3[1]!==undefined?_args3[1]:{};userDocRef=doc(db,'users',userAuth.uid);_context3.next=4;return getDoc(userDocRef);case 4:userSnapshot=_context3.sent;if(userSnapshot.exists()){_context3.next=18;break;}displayName=userAuth.displayName,email=userAuth.email;createAt=new Date();_context3.prev=8;_context3.next=11;return setDoc(userDocRef,_objectSpread({displayName:displayName,email:email,createAt:createAt},addtionalInfo)//passed username will overwrite default\n);case 11:console.log(\"create doc in db success\");alert(\"register success\");_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](8);console.log('create user error',_context3.t0.message);case 18:return _context3.abrupt(\"return\",userDocRef);case 19:case\"end\":return _context3.stop();}}},_callee3,null,[[8,15]]);}));return function createUserDocFrom(_x5){return _ref3.apply(this,arguments);};}();","map":{"version":3,"names":["getFirestore","doc","getDoc","setDoc","initializeApp","getAuth","signInWithRedirect","signInWithPopup","signInWithPhoneNumber","GoogleAuthProvider","FacebookAuthProvider","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firebaseApp","provider","Facebookprovider","setCustomParameters","prompt","auth","signinwithgooglePopup","signInWithGoogleRedirect","createAuthUserWithEmailAndPassword","email","password","console","log","signInAuthWithEmailAndPassword","SignoutUser","OnAuthstatecahngeListener","callback","db","createUserDocFrom","userAuth","addtionalInfo","userDocRef","uid","userSnapshot","exists","displayName","createAt","Date","alert","message"],"sources":["/Users/maclyuqi/clothes-store/MyProfolio/src/utilities/firebase.utils.js"],"sourcesContent":["//firestore db\nimport {getFirestore,doc,getDoc,setDoc} from 'firebase/firestore'\n\n// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";//create an app instance\nimport {getAuth,signInWithRedirect,signInWithPopup,\n    signInWithPhoneNumber,\n    GoogleAuthProvider,\n    FacebookAuthProvider,\n    createUserWithEmailAndPassword,\n    signInWithEmailAndPassword,\n    signOut,\n    onAuthStateChanged,\n\n} from 'firebase/auth'\n\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app's Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyB8FvXvvHKJ3ax1iOArErBJwePdfWO7DBE\",\n  authDomain: \"crown-clothing-db-39d8e.firebaseapp.com\",\n  projectId: \"crown-clothing-db-39d8e\",\n  storageBucket: \"crown-clothing-db-39d8e.appspot.com\",\n  messagingSenderId: \"233166638813\",\n  appId: \"1:233166638813:web:a2842dbd48732568c09534\"\n};\n\n// Initialize Firebase\nconst firebaseApp = initializeApp(firebaseConfig);\nconst provider = new GoogleAuthProvider();\nconst Facebookprovider = new FacebookAuthProvider()\n//use 不同的provider提供不同的auth，比如facebook，twitter等\nprovider.setCustomParameters(\n    {\n        prompt : \"select_account\"\n    }\n);\n\nexport const auth = getAuth();\nexport const signinwithgooglePopup = () => signInWithPopup(auth,provider);\nexport const signInWithGoogleRedirect = () => signInWithRedirect(auth,provider);\nexport const createAuthUserWithEmailAndPassword = async (email,password) => {\n    if(!email||!password) return;\n    \n    console.log(\"email create success\");\n    return await createUserWithEmailAndPassword(auth, email, password)\n}\nexport const signInAuthWithEmailAndPassword = async (email,password) => {\n    if(!email||!password) return;\n    \n    console.log(\"sign in success\");\n    return await signInWithEmailAndPassword(auth, email, password)\n}\nexport const SignoutUser = () =>{\n    signOut(auth);\n}\nexport const OnAuthstatecahngeListener = (callback) => {\n    if(!callback) return;\n    onAuthStateChanged(auth,callback);\n}\n////=---------firebase firestore db------------------///\n//firestore based on Doc model\nconst db = getFirestore(); \nexport const createUserDocFrom = async (userAuth,addtionalInfo = {}) =>{\n    \n    const userDocRef = doc(db,'users',userAuth.uid);\n    const userSnapshot = await getDoc(userDocRef)\n\n\n    if(!userSnapshot.exists())\n    {\n        const {displayName,email} = userAuth;\n        const createAt = new Date();\n        try {\n            await setDoc( userDocRef,\n                {displayName,\n                email,\n                createAt,\n                ...addtionalInfo },//passed username will overwrite default\n            )\n            console.log(\"create doc in db success\");\n            alert(\"register success\");\n        } catch (error) {\n            console.log('create user error', error.message);\n        }\n    }\n    \n    return userDocRef;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}