{"ast":null,"code":"import _defineProperty from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/maclyuqi/clothes-store/MyProfolio/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{getRedirectResult}from\"firebase/auth\";import{auth}from\"../../utilities/firebase.utils\";//distingguish import funtion and component\nimport{signinwithgooglePopup,signInWithGoogleRedirect,signInAuthWithEmailAndPassword}from\"../../utilities/firebase.utils\";import Forminput from\"../../component/form-input/form-input.component\";import Button from\"../../component/cutombutton/custombutton.component\";import'./sign-in-form.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var defaultformcontent=[{email:'',password:''}];var Signin=function Signin(){//initialize formfields\nvar _useState=useState(defaultformcontent),_useState2=_slicedToArray(_useState,2),formfields=_useState2[0],setformfields=_useState2[1];//destrcuture formfields\nvar email=formfields.email,password=formfields.password;//console.log(formfields);\n//重定向的页面，创建用户doc\nuseEffect(function(){function fetchRedirectResult(){return _fetchRedirectResult.apply(this,arguments);}function _fetchRedirectResult(){_fetchRedirectResult=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getRedirectResult(auth);case 2:case\"end\":return _context.stop();}}},_callee);}));return _fetchRedirectResult.apply(this,arguments);}fetchRedirectResult();},[]);var signinGooglePopup=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return signinwithgooglePopup();case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);alert(_context2.t0.code);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function signinGooglePopup(){return _ref.apply(this,arguments);};}();var resetFormfields=function resetFormfields(){setformfields(null);//do not refresh page?????????????\nsetformfields(defaultformcontent);};//console.log(formfields);\nvar resetPasswordFormfields=function resetPasswordFormfields(){formfields.password='';formfields.confirmPassword='';//console.log(formfields);\n};//pass value from input bar to formfields\nvar handleChange=function handleChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setformfields(_objectSpread(_objectSpread({},formfields),{},_defineProperty({},name,value)));};//confirm password\nvar SigninHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(event){var _yield$signInAuthWith,user;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0://alert(\"submit sucess\");\nevent.preventDefault();///阻止所有默认的表单操作，自动刷新页面等\n_context3.prev=1;_context3.next=4;return signInAuthWithEmailAndPassword(email,password);case 4:_yield$signInAuthWith=_context3.sent;user=_yield$signInAuthWith.user;// confirm password\nconsole.log(\"sign in user :\",user);//resetFormfields();//刷新表单 \n_context3.next=21;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);_context3.t1=_context3.t0.code;_context3.next=_context3.t1===\"auth/wrong-password\"?14:_context3.t1===\"auth/too-many-requests\"?16:_context3.t1===\"auth/user-not-found\"?18:20;break;case 14:alert(\"wrong password\");return _context3.abrupt(\"break\",21);case 16:alert(\"Access to this account has been temporarily disabled due to many failed login attempts. You can immediately restore it by resetting your password or you can try again later\");return _context3.abrupt(\"break\",21);case 18:alert(\"user does not exist\");return _context3.abrupt(\"break\",21);case 20:console.log(_context3.t0);case 21:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return function SigninHandler(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"sign-in-container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:SigninHandler,children:[/*#__PURE__*/_jsx(Forminput,{label:\"email\",required:true,onChange:handleChange,name:\"email\",value:email}),/*#__PURE__*/_jsx(Forminput,{label:\"Password\",type:\"password\",required:true,onChange:handleChange,name:\"password\",value:password}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons-container\",children:[/*#__PURE__*/_jsx(Button,{buttontype:\"inverted\",type:\"submit\",children:\"sign in\"}),/*#__PURE__*/_jsx(Button,{buttontype:\"google\",type:\"button\",onClick:signinGooglePopup,children:\"google\"})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"sign-page-text\",children:\"Don`t have an account? \"}),/*#__PURE__*/_jsx(\"span\",{className:\"sign-page-text\",children:\"sign up with your e-mail\"})]})});};export default Signin;","map":{"version":3,"names":["useState","useEffect","getRedirectResult","auth","signinwithgooglePopup","signInWithGoogleRedirect","signInAuthWithEmailAndPassword","Forminput","Button","defaultformcontent","email","password","Signin","formfields","setformfields","fetchRedirectResult","signinGooglePopup","alert","code","resetFormfields","resetPasswordFormfields","confirmPassword","handleChange","event","target","name","value","SigninHandler","preventDefault","user","console","log"],"sources":["/Users/maclyuqi/clothes-store/MyProfolio/src/component/signin/signinform.component.jsx"],"sourcesContent":["import { useState ,useEffect} from \"react\";\nimport { getRedirectResult } from \"firebase/auth\";\nimport { auth } from \"../../utilities/firebase.utils\"; //distingguish import funtion and component\nimport { signinwithgooglePopup, signInWithGoogleRedirect,signInAuthWithEmailAndPassword} from \"../../utilities/firebase.utils\";\nimport Forminput from \"../../component/form-input/form-input.component\";\nimport Button from \"../../component/cutombutton/custombutton.component\";\nimport './sign-in-form.scss'\nconst defaultformcontent = [{\n    email :'',\n    password : '',\n}]\n\nconst Signin  = () => {\n   \n    //initialize formfields\n    const [formfields,setformfields] = useState(defaultformcontent);\n    //destrcuture formfields\n    const {email,password} = formfields;\n\n    //console.log(formfields);\n    //重定向的页面，创建用户doc\n    useEffect(() => {\n        async function fetchRedirectResult()\n        {\n           await getRedirectResult(auth);\n        }\n        fetchRedirectResult();\n    },[]);\n\n    const signinGooglePopup = async () => {\n        //获取google给的auth信息，内部有一个user参数，里面包含uid\n        try\n        {\n            await signinwithgooglePopup();\n        }\n        catch(error)\n        {\n            alert(error.code);\n        }\n    }\n   \n    const resetFormfields = () =>\n    {\n        setformfields(null);\n        //do not refresh page?????????????\n        setformfields(defaultformcontent);\n    }\n    //console.log(formfields);\n    const resetPasswordFormfields = () =>\n    {\n        formfields.password = '';\n        formfields.confirmPassword = '';\n        //console.log(formfields);\n    }\n    //pass value from input bar to formfields\n    const handleChange = (event) =>{\n        const {name,value} = event.target;\n        setformfields({...formfields,[name]:value});\n    }\n    //confirm password\n    const SigninHandler = async (event) =>\n    {\n        //alert(\"submit sucess\");\n        event.preventDefault();///阻止所有默认的表单操作，自动刷新页面等\n        try{\n            const {user} = await signInAuthWithEmailAndPassword(email,password);// confirm password\n            console.log(\"sign in user :\",user);\n            //resetFormfields();//刷新表单 \n        }\n        catch(error)\n        {\n            switch(error.code)\n            {\n                case \"auth/wrong-password\":\n                alert(\"wrong password\");\n                break;\n                case \"auth/too-many-requests\":\n                alert(\"Access to this account has been temporarily disabled due to many failed login attempts. You can immediately restore it by resetting your password or you can try again later\")\n                break;\n                case \"auth/user-not-found\":\n                alert(\"user does not exist\");\n                break;\n                default:\n                console.log(error);\n            }\n        }\n    }\n    return(\n        \n        <div className=\"sign-in-container\">           \n            <form onSubmit={SigninHandler}>\n                \n                <Forminput label=\"email\" required onChange={handleChange} name = \"email\" value = {email}></Forminput>\n               \n                <Forminput label=\"Password\"  type = \"password\" required onChange={handleChange} name = \"password\" value = {password}></Forminput>\n\n                <div className=\"buttons-container\">\n                <Button buttontype=\"inverted\" type=\"submit\" >sign in</Button>\n                <Button buttontype=\"google\" type=\"button\" onClick={signinGooglePopup}>google</Button>\n                </div>\n                <h3 className=\"sign-page-text\">Don`t have an account? </h3>\n                <span className=\"sign-page-text\">sign up with your e-mail</span>\n            </form>         \n        </div>\n        \n    )\n}\n\nexport default Signin;"],"mappings":"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"},"metadata":{},"sourceType":"module"}